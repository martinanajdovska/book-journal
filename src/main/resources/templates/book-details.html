<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-6">
            <img style="max-height: 20rem;" th:src="@{'/uploads/'+${book.getFile()}}" alt="Image for book">
        </div>
        <div class="col-6">
            <h3 th:text="${book.getTitle()}"></h3>
            <h2 th:text="${book.getAuthor()}"></h2>
            <p th:text="${book.getPages()}"></p>
            <th:block th:if="${hasRead && userReadBook != null}">
                    <form method="post" th:action="'/books/read/'+${book.getId()}">
                        <div class="form-group">
                            <label for="startedDate">Started date:</label>
                            <input type="date"
                                   class="form-control"
                                   id="startedDate"
                                   name="startedDate"
                                   th:value="(${userReadBook.getStartedDate()} != null ? ${userReadBook.getStartedDate()} : null)"
                                   placeholder="startedDate">
                            <label for="finishedDate">Finished date:</label>
                            <input type="date"
                                   class="form-control"
                                   id="finishedDate"
                                   name="finishedDate"
                                   th:value="(${userReadBook.getFinishedDate()} != null ? ${userReadBook.getFinishedDate()} : null)"
                                   placeholder="finishedDate">
                        </div>
                        <input type="submit" class="btn btn-primary" value="Add dates">
                    </form>
            </th:block>
            <p th:text="${book.getDescription()}"></p>
        </div>
        <a th:if="${!hasRead}" th:href="${'/books/read/'+book.getId()}">Assign as read</a>
        <a th:if="${hasRead}" th:href="${'/books/remove-read/'+book.getId()}">Remove from read</a>
    </div>
    <div class="row">
        <th:block th:if="${hasRead}">
            <form method="post" th:action="'/books/review/'+${book.getId()}">
                <label for="review">Add review:</label>
                <textarea class="form-control" name="review" id="review" cols="30" rows="10">Enter review</textarea>
                <input type="submit" class="btn btn-primary" value="Submit">
            </form>
        </th:block>
        <th:block th:if="${reviews.size() > 0}">
            <div th:each="review : ${reviews}" class="col-6">
                <p th:text="${review.getUser().getUsername()}"></p>
                <p th:text="${review.getReview()}"></p>
            </div>
        </th:block>
    </div>
</div>
</body>
</html>